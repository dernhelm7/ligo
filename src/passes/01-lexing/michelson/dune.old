;; Build of the Michelson lexer as a library

(ocamllex Token)

(library
  (name lexing_michelson)
  (public_name ligo.lexing.michelson)
  (modules Token Pair Self_tokens)
  (libraries
    ;; Vendors
    lexing_shared
    ;; Third party
    str
    zarith
    hex))

;; Build of a standalone lexer for Michelson

(executable
  (name LexerMain)
  (libraries
    ;; LIGO
    preprocessing_michelson
    lexing_shared
    lexing_michelson
    ;; Third party
    str)
  (modules Version LexerMain))

;; --------------------------------------------------------------------
;; Build of the version source (for the user, as a CLI option)

(rule
 (targets Version.ml)
 (action (with-stdout-to
          Version.ml
          (run "sh" "-c"
               "printf 'let version = \"%s\"' \"${LIGO_VERSION}\""))))
