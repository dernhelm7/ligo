(rule
  (targets generated_fold.ml)
  (deps ../adt_generator/Parser.pm ../adt_generator/fold.raku ast.ml ../common/enums.ml)
  (action (run perl6 -I ../adt_generator/ ../adt_generator/fold.raku ast.ml generated_fold.ml))
  (mode (promote (until-clean) (only *)))
)
(rule
  (targets generated_o.ml)
  (deps ../adt_generator/Parser.pm ../adt_generator/combinators.raku ast.ml ../common/enums.ml)
  (action (run perl6 -I ../adt_generator/ ../adt_generator/combinators.raku ast.ml generated_o.ml))
  (mode (promote (until-clean) (only *)))
)
(rule
  (targets generated_map.ml)
  (deps ../adt_generator/Parser.pm ../adt_generator/fold_map.raku ast.ml ../common/enums.ml)
  (action (run perl6 -I ../adt_generator/ ../adt_generator/fold_map.raku ast.ml Generated_o generated_map.ml))
  (mode (promote (until-clean) (only *)))
)

(library
  (name ast_core)
  (public_name ligo.ast_core)
  (libraries
    simple-utils
    stage_common
    ast_sugar
    adt_generator
  )
  (preprocess
    (pps ppx_let bisect_ppx --conditional)
  )
  (flags (:standard -open Simple_utils ))
)
